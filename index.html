<!doctype html>
<html lang="">

<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Permissioneditor 0.1.4</title>
  <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

  <!-- build:css styles/main.css -->
  <link rel="stylesheet" href="styles/main.css">
  <!-- endbuild-->

  <!-- build:js bower_components/webcomponentsjs/webcomponents.min.js -->
  <script src="bower_components/webcomponentsjs/webcomponents.js"></script>
  <!-- endbuild -->

  <!-- will be replaced with elements/elements.vulcanized.html -->
  <link rel="import" href="elements/elements.html">
  <!-- endreplace-->
</head>

<body unresolved layout vertical>
    <polymer-element name="permission-edit">
        <template>
            <link rel="stylesheet" href="styles/main.css">
            <core-ajax id="ajax" auto url="scripts/plugins.json" handleAs="json" response="{{permissions}}" on-core-response="{{test}}"></core-ajax>
            
            
            <paper-dialog transition="core-transition-top" opened="{{openimport}}">
                <div style="height: 75vh;width:75vw">
                    <textarea style="height: 100%;width: 100%" value="{{yaml}}" placeholder="Import"></textarea>
                </div>
            </paper-dialog>
            
            
            
            <paper-dialog transition="core-transition-top" opened="{{openexport}}">
                <div style="height: 75vh;width:75vw">
                    <textarea style="height: 100%;width: 100%" value="{{yamlnew}}" placeholder="Export"></textarea>
                </div>
            </paper-dialog>
      
            <yaml-js yaml="{{yaml}}" js="{{jsnew}}" mode="tojs" on-core-ready="{{loadPermissions}}"></yaml-js>
            <yaml-js yaml="{{yamlnew}}" js="{{js}}" mode="toyaml" on-core-ready="{{loadPermissions}}"></yaml-js>
            
            <template if="{{selectedVersion}}">
                <div>
                        <paper-button raised on-tap="{{openimportfkt}}">Import</paper-button>
                        <paper-button raised on-tap="{{save}}{{openexportfkt}}">Export</paper-button>
                        <paper-button raised on-tap="{{openaddgroupfkt}}">Gruppe hinzufügen</paper-button>
                        <paper-button raised on-tap="{{openaddpluginfkt}}" style="margin-top: 2px">Plugin hinzufügen</paper-button>
                    </div>
                
                <div class="mainlayout">
                    <div class="buttonlist">          
                        <paper-shadow>
                            <core-selector selected="{{SelectedGroup}}">
                                <template repeat="{{group in groups}}">
                                    <paper-item style="margin-top: 2px">{{group.name}}</paper-item>
                                </template>
                            </core-selector>
                        </paper-shadow>
                    </div>
                    <div class="buttonlist">
                        <paper-shadow>
                            <core-selector selected="{{SelectedPlugin}}">
                                <template repeat="{{plugin, index in permissions}}">
                                    <paper-item style="margin-top: 2px">{{plugin.plugin}}</paper-item>
                                </template>
                            </core-selector>
                        </paper-shadow>
                    </div>
                    <div>
                        <template if="{{SelectedGroup != undefined && SelectedPlugin != undefined}}">
                            <div class="permission item" layout horizontal on-tap="{{allcheckboxchanged}}">
                                <paper-checkbox checked?="{{groups[SelectedGroup].permissions[permissions[SelectedPlugin].plugin]['*']}}"></paper-checkbox>
                                
                                <div class="key">
                                    {{permissions[SelectedPlugin].plugin}}.*
                                </div>
                                Wähl alle Permissions des Plugins aus.
                            </div>
                            <template repeat="{{permission in permissions[SelectedPlugin].permissions}}">
                                <div class="permission item" layout horizontal on-tap="{{checkboxchanged}}">
                                    <paper-checkbox checked?="{{groups[SelectedGroup].permissions[permissions[SelectedPlugin].plugin][permission.name]}}"></paper-checkbox>
                                    <div class="key">
                                        {{permissions[SelectedPlugin].plugin}}.{{permission.name}}
                                    </div>
                                    {{permission.description}}
                                </div>
                            </template>
                        </template>
                    </div>
                </div> 
                
                
                
                <!--Dialoge-->
                
                <paper-dialog transition="core-transition-top" header="Gruppe hinzufügen" opened="{{openaddgroup}}">
                    <div id="addgroup" layout vertical>
                        <paper-input-decorator floatingLabel label="Gruppen Name" isInvalid?="{{!newGroup.namevalid}}" error="Es muss ein noch nicht vorhandener Name angegeben werden">
                            <input value="{{newGroup.name}}" is="core-input">
                        </paper-input-decorator>
                        <paper-input-decorator floatingLabel label="Prefix" isInvalid?="{{newGroup.prefixvalid}}" error="Error">
                            <input is="core-input" value="{{newGroup.prefix}}">
                        </paper-input-decorator>
                        <paper-input-decorator floatingLabel label="Suffix" isInvalid?="{{newGroup.suffixvalid}}" error="Error">
                            <input is="core-input" value="{{newGroup.suffix}}">
                        </paper-input-decorator>
                        <paper-input-decorator floatingLabel label="rank" isInvalid?="{{!$.inputrank.validity.valid}}" error="Rank muss eine Zahl sein">
                            <input id="inputrank" value="{{newGroup.rank}}" type="number" is="core-input" pattern="^[0-9]*">
                        </paper-input-decorator>

                        <paper-dropdown-menu label="Gruppe kopieren">
                            <paper-dropdown class="dropdown">
                                <core-menu class="menu" selected="{{newGroup.import}}">
                                    <paper-item>keine</paper-item>
                                    <template repeat="{{group in groups}}">
                                        <paper-item>{{group.name}}</paper-item>
                                    </template>
                                </core-menu>
                            </paper-dropdown>
                        </paper-dropdown-menu>

                        <paper-button raised toggle active="{{newGroup.default}}">Default</paper-button>
                        <br>
                        <paper-button raised on-tap="{{addGroup}}">Hinzufügen</paper-button>
                    </div>
                </paper-dialog>
            </template>
            
            <paper-dialog transition="core-transition-top" header="Plugin hinzufügen" opened="{{openaddplugin}}">
                <div style="height: 75vh;width:75vw">
                    bla bla bla
                </div>
            </paper-dialog>
        </template>

        <!-- build:js scripts/app.js -->
        <script src="scripts/app.js"></script>
        <!-- endbuild-->
    </polymer-element>
    <permission-edit></permission-edit>
    <div class="imprint">
        <a href="http://lergin.lima-city.de/impressum.html" rel="nofollow">Impressum</a>
        <a href="http://lergin.lima-city.de/datenschutz.html" rel="nofollow">Datenschutz</a>
    </div>
</body>

</html>
