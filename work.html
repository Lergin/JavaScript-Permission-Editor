<!doctype html>
<html lang="de,en">

<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Permissioneditor 0.2.3</title>
  <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

  <!-- build:css styles/main.min.css -->
  <link rel="stylesheet" href="styles/main.css">
  <!-- endbuild-->

  <!-- build:js bower_components/webcomponentsjs/webcomponents.min.js -->
  <script src="bower_components/webcomponentsjs/webcomponents.js"></script>
  <!-- endbuild -->
    
  <!-- will be replaced with elements/elements.vulcanized.html -->
  <link rel="import" href="elements/elements.html">
  <!-- endreplace-->
</head>

<body unresolved layout vertical>
    <polymer-element name="permission-edit">
        <template>
            <link rel="stylesheet" href="styles/main.css">
            <core-ajax auto url="scripts/plugins.json" handleAs="json" response="{{plugins}}"></core-ajax>
            <core-ajax auto url="locales/{{lang}}.json" handleAs="json" response="{{translation}}"></core-ajax>
            <core-ajax auto url="Plugins/{{newpluginname}}.json" handleAs="json" response="{{newpluginobj}}" on-core-response="{{openPlugin}}"></core-ajax>
            <yaml-js yaml="{{yaml}}" js="{{jsnew}}" mode="tojs" on-core-ready="{{loadPermissions}}"></yaml-js>
            <yaml-js yaml="{{yamlnew}}" js="{{js}}" mode="toyaml"></yaml-js>
            <yaml-js yaml="{{pluginyaml}}" js="{{newplugin}}" mode="tojs" on-core-ready="{{loadPlugin}}"></yaml-js>
            <div>
                <paper-button raised on-tap="{{openimportfkt}}">{{translation.action.import}}</paper-button>
                <paper-button raised on-tap="{{save}}{{openexportfkt}}">{{translation.action.export}}</paper-button>
                <paper-button raised on-tap="{{openaddgroupfkt}}">{{translation.group.add}}</paper-button>
                <paper-button raised on-tap="{{openaddpluginfkt}}" style="margin-top: 2px">{{translation.plugin.add}}</paper-button>
            </div>

            <div class="mainlayout">
                <div class="buttonlist">          
                    <paper-shadow>
                        <core-selector selected="{{SelectedGroup}}">
                            <template repeat="{{group in groups}}">
                                <paper-item style="margin-top: 2px">
                                    <span flex>{{group.name}}</span>
                                    <core-icon on-tap="{{openeditgroupfkt}}" icon="editor:mode-edit"></core-icon>
                                </paper-item>
                            </template>
                        </core-selector>
                    </paper-shadow>
                </div>
                <div class="buttonlist">
                    <paper-shadow>
                        <core-selector selected="{{SelectedPlugin}}">
                            <template repeat="{{plugin, index in permissions}}">
                                <paper-item style="margin-top: 2px">
                                    <span flex>{{plugin.plugin}}</span>
                                    <core-icon on-tap="{{delplugin}}" icon="delete"></core-icon>
                                </paper-item>
                            </template>
                        </core-selector>
                    </paper-shadow>
                </div>
                <div>
                    <template if="{{SelectedGroup != undefined && SelectedPlugin != undefined}}">
                        <template repeat="{{permission in permissions[SelectedPlugin].permissions}}">
                            <div class="permission item" layout horizontal on-tap="{{checkboxchanged}}">
                                <paper-checkbox checked?="{{groups[SelectedGroup].permissions[permissions[SelectedPlugin].plugin][permission.name]}}"></paper-checkbox>
                                <div class="key">
                                    {{permission.name}}
                                </div>
                                {{permission.description}}
                            </div>
                        </template>
                    </template>
                </div>
            </div> 



            <!--Dialoge-->

            <paper-dialog backdrop transition="core-transition-top" opened="{{openaddgroup}}">
                <div id="addgroup" layout vertical>
                    <paper-input-decorator floatingLabel label="{{translation.group.name}}" isInvalid?="{{!newGroup.namevalid}}" error="Es muss ein noch nicht vorhandener Name angegeben werden">
                        <input value="{{newGroup.name}}" is="core-input">
                    </paper-input-decorator>
                    <paper-input-decorator floatingLabel label="{{translation.group.prefix}}" isInvalid?="{{newGroup.prefixvalid}}" error="Error">
                        <input is="core-input" value="{{newGroup.prefix}}">
                    </paper-input-decorator>
                    <paper-input-decorator floatingLabel label="{{translation.group.suffix}}" isInvalid?="{{newGroup.suffixvalid}}" error="Error">
                        <input is="core-input" value="{{newGroup.suffix}}">
                    </paper-input-decorator>
                    <paper-input-decorator floatingLabel label="{{translation.group.rank}}" isInvalid?="{{!$.inputrank.validity.valid}}" error="Rank muss eine Zahl sein">
                        <input id="inputrank" value="{{newGroup.rank}}" type="number" is="core-input" pattern="^[0-9]*">
                    </paper-input-decorator>

                    <paper-dropdown-menu label="{{translation.group.copy}}">
                        <paper-dropdown layered class="dropdown">
                            <core-menu class="menu" selected="{{newGroup.import}}">
                                <paper-item>{{translation.none}}</paper-item>
                                <template repeat="{{group in groups}}">
                                    <paper-item>{{group.name}}</paper-item>
                                </template>
                            </core-menu>
                        </paper-dropdown>
                    </paper-dropdown-menu>

                    <paper-button raised toggle active="{{newGroup.default}}">{{translation.group.default}}</paper-button>
                    <br>
                    <paper-button raised on-tap="{{addGroup}}">{{translation.action.add}}</paper-button>
                </div>
            </paper-dialog>

            <paper-dialog backdrop transition="core-transition-top" opened="{{openeditgroup}}">
                <div layout vertical>
                    <paper-input-decorator floatingLabel label="{{translation.group.name}}" error="Es muss ein noch nicht vorhandener Name angegeben werden">
                        <input value="{{editgroup.name}}" is="core-input">
                    </paper-input-decorator>
                    <paper-input-decorator floatingLabel label="{{translation.group.prefix}}" isInvalid?="{{editgroup.prefixvalid}}" error="Error">
                        <input is="core-input" value="{{editgroup.options.prefix}}">
                    </paper-input-decorator>
                    <paper-input-decorator floatingLabel label="{{translation.group.suffix}}" isInvalid?="{{editgroup.suffixvalid}}" error="Error">
                        <input is="core-input" value="{{editgroup.options.suffix}}">
                    </paper-input-decorator>
                    <paper-input-decorator floatingLabel label="{{translation.group.rank}}" isInvalid?="{{!$.editinputrank.validity.valid}}" error="Rank muss eine Zahl sein">
                        <input id="editinputrank" value="{{editgroup.options.rank}}" type="number" is="core-input" pattern="^[0-9]*">
                    </paper-input-decorator>

                    <paper-button id="editdefaultbutton" raised toggle on-tap="{{changeGroupsDefault}}">{{translation.group.default}}</paper-button>
                    <br>
                    <paper-button raised on-tap="{{delGroup}}">{{translation.group.delete}}</paper-button>
                </div>
            </paper-dialog>

            <paper-dialog backdrop transition="core-transition-top" opened="{{openimport}}">
                <div style="height: 75vh;width:75vw">
                    <textarea style="height: 100%;width: 100%" value="{{yaml}}" placeholder="{{translation.action.import}}"></textarea>
                </div>
            </paper-dialog>

            <paper-dialog backdrop transition="core-transition-top" opened="{{openexport}}" >
                <div style="height: 75vh;width:75vw">
                    <textarea style="height: 100%;width: 100%" value="{{yamlnew}}" placeholder="{{translation.action.export}}"></textarea>
                </div>
            </paper-dialog>

           <paper-dialog backdrop transition="core-transition-top" opened="{{openaddplugin}}">
                <div vertical center-justified layout>
                    <paper-dropdown-menu label="{{translation.plugin.select}}">
                        <paper-dropdown layered class="dropdown">
                            <core-menu class="menu" id="pluginselectmenu" selected="{{newpluginname}}" valueattr="name">
                                <template repeat="{{plugin in plugins}}">
                                    <paper-item name="{{plugin}}">{{plugin}}</paper-item>
                                </template>
                            </core-menu>
                        </paper-dropdown>
                    </paper-dropdown-menu>
                    <br>
                    <paper-button raised on-tap="{{openaddpluginbyfilefkt}}">{{translation.plugin.addouther}}</paper-button>
                </div>
            </paper-dialog>

            <paper-dialog backdrop transition="core-transition-top" opened="{{openaddpluginbyfile}}">
                <div style="height: 75vh;width:75vw">
                    <textarea style="height: 100%;width: 100%" value="{{pluginyaml}}" placeholder="Plugin.yml"></textarea>
                </div>
            </paper-dialog>
        </template>

        <!-- build:js scripts/app.min.js -->
        <script src="scripts/app.js"></script>
        <!-- endbuild-->
        
        
    </polymer-element>
    <permission-edit></permission-edit>
    <span class="imprint">
        <a href="http://lergin.lima-city.de/impressum.html" rel="nofollow">Impressum</a>
        <a href="http://lergin.lima-city.de/datenschutz.html" rel="nofollow">Datenschutz</a>
        Copyright &copy; 2015 Malte 'Lergin' Lauk&ouml;tter
    </span>
</body>

</html>
